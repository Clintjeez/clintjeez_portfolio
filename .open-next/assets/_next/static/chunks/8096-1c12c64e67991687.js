"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8096],{81260:function(e,t,a){a.d(t,{ResetPreferences:function(){return c}});var n=a(60605),i=a(57437),r=a(23521),l=a(76578),s=a(32723),o=a(2265);let u="confirm-reset-modal",c=e=>{let t,a,c;let d=(0,n.c)(9),{apiRoute:m,user:h}=e,{openModal:f}=(0,r.useModal)(),{t:g}=(0,l.d)();d[0]!==m||d[1]!==h?(t=async()=>{if(!h)return;let e=s.P({depth:0,where:{user:{id:{equals:h.id}}}},{addQueryPrefix:!0});try{let t=await fetch("".concat(m,"/payload-preferences").concat(e),{credentials:"include",headers:{"Content-Type":"application/json"},method:"DELETE"}),a=(await t.json()).message;t.ok?r.toast.success(a):r.toast.error(a)}catch(e){}},d[0]=m,d[1]=h,d[2]=t):t=d[2];let p=t;return d[3]!==f?(a=()=>f(u),d[3]=f,d[4]=a):a=d[4],d[5]!==p||d[6]!==g||d[7]!==a?(c=(0,i.jsxs)(o.Fragment,{children:[(0,i.jsx)("div",{children:(0,i.jsx)(r.Button,{buttonStyle:"secondary",onClick:a,children:g("general:resetPreferences")})}),(0,i.jsx)(r.ConfirmationModal,{body:g("general:resetPreferencesDescription"),confirmingLabel:g("general:resettingPreferences"),heading:g("general:resetPreferences"),modalSlug:u,onConfirm:p})]}),d[5]=p,d[6]=g,d[7]=a,d[8]=c):c=d[8],c}},77853:function(e,t,a){a.d(t,{LanguageSelector:function(){return s}});var n=a(60605),i=a(57437),r=a(76578),l=a(23521);a(2265);let s=e=>{let t,a;let s=(0,n.c)(8),{languageOptions:o}=e,{i18n:u,switchLanguage:c}=(0,r.d)();if(s[0]!==c?(t=async e=>{await c(e.value)},s[0]=c,s[1]=t):t=s[1],s[2]!==u||s[3]!==o||s[4]!==t){let e;s[6]!==u?(e=e=>e.value===u.language,s[6]=u,s[7]=e):e=s[7],a=(0,i.jsx)(l.ReactSelect,{inputId:"language-select",isClearable:!1,onChange:t,options:o,value:o.find(e)}),s[2]=u,s[3]=o,s[4]=t,s[5]=a}else a=s[5];return a}},17401:function(e,t,a){a.d(t,{ToggleTheme:function(){return o}});var n=a(60605),i=a(57437),r=a(64667),l=a(76578),s=a(23521);a(2265);let o=()=>{let e,t;let a=(0,n.c)(7),{autoMode:o,setTheme:u,theme:c}=(0,r.h)(),{t:d}=(0,l.d)();a[0]!==u?(e=e=>{u(e)},a[0]=u,a[1]=e):e=a[1];let m=e;return a[2]!==o||a[3]!==m||a[4]!==d||a[5]!==c?(t=(0,i.jsx)(s.RadioGroupField,{disableModifyingForm:!0,field:{name:"theme",label:d("general:adminTheme"),options:[{label:d("general:automatic"),value:"auto"},{label:d("general:light"),value:"light"},{label:d("general:dark"),value:"dark"}]},onChange:m,path:"theme",value:o?"auto":c}),a[2]=o,a[3]=m,a[4]=d,a[5]=c,a[6]=t):t=a[6],t}},28415:function(e,t,a){a.d(t,{AccountClient:function(){return s}});var n=a(60605),i=a(23521),r=a(76578),l=a(2265);let s=()=>{let e,t;let a=(0,n.c)(4),{setStepNav:s}=(0,i.useStepNav)(),{t:o}=(0,r.d)();return a[0]!==s||a[1]!==o?(e=()=>{let e=[];e.push({label:o("authentication:account"),url:"/account"}),s(e)},t=[s,o],a[0]=s,a[1]=o,a[2]=e,a[3]=t):(e=a[2],t=a[3]),l.useEffect(e,t),null}},94464:function(e,t,a){a.d(t,{CreateFirstUserClient:function(){return u}});var n=a(57437),i=a(64667),r=a(23521),l=a(76578),s=a(60289),o=a(2265);let u=e=>{let{docPermissions:t,docPreferences:a,initialState:u,loginWithUsername:c,userSlug:d}=e,{config:{routes:{admin:m,api:h},serverURL:f},getEntityConfig:g}=(0,i.b)(),{getFormState:p}=(0,r.useServerFunctions)(),{t:v}=(0,l.d)(),{setUser:x}=(0,r.useAuth)(),j=o.useRef(null),w=g({collectionSlug:d}),b=o.useCallback(async e=>{let{formState:n,submitted:i}=e,r=(0,s.ds)(j),l=await p({collectionSlug:d,docPermissions:t,docPreferences:a,formState:n,operation:"create",schemaPath:d,signal:r.signal,skipValidation:!i});if(j.current=null,l&&l.state)return l.state},[d,p,t,a]);return(0,o.useEffect)(()=>{let e=j.current;return()=>{(0,s.jg)(e)}},[]),(0,n.jsxs)(r.Form,{action:"".concat(f).concat(h,"/").concat(d,"/first-register"),initialState:u,method:"POST",onChange:[b],onSuccess:e=>{x(e)},redirect:m,validationOperation:"create",children:[(0,n.jsx)(r.EmailAndUsernameFields,{className:"emailAndUsername",loginWithUsername:c,operation:"create",readOnly:!1,t:v}),(0,n.jsx)(r.PasswordField,{autoComplete:"off",field:{name:"password",label:v("authentication:newPassword"),required:!0},path:"password"}),(0,n.jsx)(r.ConfirmPasswordField,{}),(0,n.jsx)(r.RenderFields,{fields:w.fields,forceRender:!0,parentIndexPath:"",parentPath:"",parentSchemaPath:d,permissions:!0,readOnly:!1}),(0,n.jsx)(r.FormSubmit,{size:"large",children:v("general:create")})]})}},69154:function(e,t,a){a.d(t,{ForgotPasswordForm:function(){return d}});var n=a(60605),i=a(57437),r=a(64667),l=a(76578),s=a(23521),o=a(8707),u=a(2265);function c({description:e,heading:t}){return t?(0,i.jsxs)("div",{className:"form-header",children:[(0,i.jsx)("h1",{children:t}),!!e&&(0,i.jsx)("p",{children:e})]}):null}let d=()=>{var e;let t,a,d,m;let h=(0,n.c)(17),{config:f,getEntityConfig:g}=(0,r.b)(),{admin:p,routes:v}=f,{user:x}=p,{api:j}=v,{t:w}=(0,l.d)(),[b,S]=(0,u.useState)(!1);h[0]!==g||h[1]!==x?(t=g({collectionSlug:x}),h[0]=g,h[1]=x,h[2]=t):t=h[2];let F=t,P=null==F?void 0:null===(e=F.auth)||void 0===e?void 0:e.loginWithUsername;h[3]!==P||h[4]!==w?(a=(e,t,a)=>{e.json().then(()=>{S(!0),t(w("general:submissionSuccessful"))}).catch(()=>{a(P?w("authentication:usernameNotValid"):w("authentication:emailNotValid"))})},h[3]=P,h[4]=w,h[5]=a):a=h[5];let y=a;if(h[6]!==j||h[7]!==f||h[8]!==y||h[9]!==b||h[10]!==P||h[11]!==w||h[12]!==x){m=Symbol.for("react.early_return_sentinel");e:{let e=P?{username:{initialValue:"",valid:!0,value:void 0}}:{email:{initialValue:"",valid:!0,value:void 0}};if(b){let e;h[15]!==w?(e=(0,i.jsx)(c,{description:w("authentication:checkYourEmailForPasswordReset"),heading:w("authentication:emailSent")}),h[15]=w,h[16]=e):e=h[16],m=e;break e}d=(0,i.jsxs)(s.Form,{action:"".concat(j,"/").concat(x,"/forgot-password"),handleResponse:y,initialState:e,method:"POST",children:[(0,i.jsx)(c,{description:P?w("authentication:forgotPasswordUsernameInstructions"):w("authentication:forgotPasswordEmailInstructions"),heading:w("authentication:forgotPassword")}),P?(0,i.jsx)(s.TextField,{field:{name:"username",label:w("authentication:username"),required:!0},path:"username",validate:e=>(0,o.fL)(e,{name:"username",type:"text",blockData:{},data:{},event:"onChange",path:["username"],preferences:{fields:{}},req:{payload:{config:f},t:w},required:!0,siblingData:{}})}):(0,i.jsx)(s.EmailField,{field:{name:"email",admin:{autoComplete:"email"},label:w("general:email"),required:!0},path:"email",validate:e=>(0,o.Do)(e,{name:"email",type:"email",blockData:{},data:{},event:"onChange",path:["email"],preferences:{fields:{}},req:{payload:{config:f},t:w},required:!0,siblingData:{}})}),(0,i.jsx)(s.FormSubmit,{size:"large",children:w("general:submit")})]})}h[6]=j,h[7]=f,h[8]=y,h[9]=b,h[10]=P,h[11]=w,h[12]=x,h[13]=d,h[14]=m}else d=h[13],m=h[14];return m!==Symbol.for("react.early_return_sentinel")?m:d}},33085:function(e,t,a){a.d(t,{LoginForm:function(){return g}});var n=a(60605),i=a(57437),r=a(2265),l=a(64667),s=a(76578),o=a(23521);let u=e=>({canLoginWithEmail:!e||e.allowEmailLogin,canLoginWithUsername:!!e}),c=({allowAbsoluteUrls:e=!1,fallbackTo:t="/",redirectTo:a})=>{let n;if("string"!=typeof a)return t;try{n=decodeURIComponent(a.trim())}catch{return t}let i=n.startsWith("/")&&!n.startsWith("//")&&!n.startsWith("/%2F")&&!n.startsWith("/\\/")&&!n.startsWith("/\\\\")&&!n.startsWith("/\\")&&!n.toLowerCase().startsWith("/javascript:")&&!n.toLowerCase().startsWith("/http"),r=e&&/^https?:\/\/\S+$/i.test(n);return i||r?n:t};var d=a(34964),m=a(8707);let h=e=>{let t=(0,n.c)(11),{type:a,required:r}=e,l=void 0===r||r,{t:u}=(0,s.d)();if("email"===a){let e;return t[0]!==l||t[1]!==u?(e=(0,i.jsx)(o.EmailField,{field:{name:"email",admin:{autoComplete:"email"},label:u("general:email"),required:l},path:"email",validate:m.Do}),t[0]=l,t[1]=u,t[2]=e):e=t[2],e}if("username"===a){let e;return t[3]!==l||t[4]!==u?(e=(0,i.jsx)(o.TextField,{field:{name:"username",label:u("authentication:username"),required:l},path:"username",validate:m.b6}),t[3]=l,t[4]=u,t[5]=e):e=t[5],e}if("emailOrUsername"===a){let e;if(t[6]!==l||t[7]!==u){let a;t[9]!==u?(a=(e,t)=>{let a=(0,m.b6)(e,t),n=(0,m.Do)(e,t);return!!n||!!a||"".concat(u("general:email"),": ").concat(n," ").concat(u("general:username"),": ").concat(a)},t[9]=u,t[10]=a):a=t[10],e=(0,i.jsx)(o.TextField,{field:{name:"username",label:u("authentication:emailOrUsername"),required:l},path:"username",validate:a}),t[6]=l,t[7]=u,t[8]=e}else e=t[8];return e}return null},f="login__form",g=e=>{let t,a,m,g;let p=(0,n.c)(23),{prefillEmail:v,prefillPassword:x,prefillUsername:j,searchParams:w}=e,{config:b,getEntityConfig:S}=(0,l.b)(),{admin:F,routes:P}=b,{routes:y,user:C}=F,{forgot:k}=y,{admin:T,api:R}=P;if(p[0]!==S||p[1]!==C){let{auth:e}=S({collectionSlug:C});a=u(t=e.loginWithUsername),p[0]=S,p[1]=C,p[2]=t,p[3]=a}else t=p[2],a=p[3];let{canLoginWithEmail:E,canLoginWithUsername:W}=a;p[4]!==E||p[5]!==W?(m=()=>E&&W?"emailOrUsername":W?"username":"email",p[4]=E,p[5]=W,p[6]=m):m=p[6];let[O]=r.useState(m),{t:_}=(0,s.d)(),{setUser:L}=(0,o.useAuth)(),U=null!=x?x:void 0,q=null!=x?x:void 0;if(p[7]!==T||p[8]!==R||p[9]!==k||p[10]!==O||p[11]!==t||p[12]!==v||p[13]!==j||p[14]!==(null==w?void 0:w.redirect)||p[15]!==L||p[16]!==_||p[17]!==U||p[18]!==q||p[19]!==C){let e;let a={password:{initialValue:U,valid:!0,value:q}};t?a.username={initialValue:null!=j?j:void 0,valid:!0,value:null!=j?j:void 0}:a.email={initialValue:null!=v?v:void 0,valid:!0,value:null!=v?v:void 0},p[21]!==L?(e=e=>{L(e)},p[21]=L,p[22]=e):e=p[22];let n=e;g=(0,i.jsxs)(o.Form,{action:"".concat(R,"/").concat(C,"/login"),className:f,disableSuccessStatus:!0,initialState:a,method:"POST",onSuccess:n,redirect:c({fallbackTo:T,redirectTo:null==w?void 0:w.redirect}),waitForAutocomplete:!0,children:[(0,i.jsxs)("div",{className:"".concat(f,"__inputWrap"),children:[(0,i.jsx)(h,{type:O}),(0,i.jsx)(o.PasswordField,{field:{name:"password",label:_("general:password"),required:!0},path:"password"})]}),(0,i.jsx)(o.Link,{href:(0,d.$)({adminRoute:T,path:k}),prefetch:!1,children:_("authentication:forgotPasswordQuestion")}),(0,i.jsx)(o.FormSubmit,{size:"large",children:_("authentication:login")})]}),p[7]=T,p[8]=R,p[9]=k,p[10]=O,p[11]=t,p[12]=v,p[13]=j,p[14]=null==w?void 0:w.redirect,p[15]=L,p[16]=_,p[17]=U,p[18]=q,p[19]=C,p[20]=g}else g=p[20];return g}},86196:function(e,t,a){a.d(t,{LogoutClient:function(){return c}});var n=a(60605),i=a(57437),r=a(23521),l=a(76578),s=a(16463),o=a(34964),u=a(2265);let c=e=>{let t,a,c,d,m;let h=(0,n.c)(23),{adminRoute:f,inactivity:g,redirect:p}=e,{logOut:v,user:x}=(0,r.useAuth)(),{startRouteTransition:j}=(0,r.useRouteTransition)(),[w,b]=u.useState(!x),S=u.useRef(!1);h[0]!==f||h[1]!==g||h[2]!==p?(t=()=>(0,o.$)({adminRoute:f,path:"/login".concat(g&&p&&p.length>0?"?redirect=".concat(encodeURIComponent(p)):"")}),h[0]=f,h[1]=g,h[2]=p,h[3]=t):t=h[3];let[F]=u.useState(t),{t:P}=(0,l.d)(),y=(0,s.useRouter)();h[4]!==g||h[5]!==v||h[6]!==F||h[7]!==y||h[8]!==j||h[9]!==P?(a=async()=>{let e=await v();if(b(e),!g&&e&&!S.current){r.toast.success(P("authentication:loggedOutSuccessfully")),S.current=!0,j(()=>y.push(F));return}},h[4]=g,h[5]=v,h[6]=F,h[7]=y,h[8]=j,h[9]=P,h[10]=a):a=h[10];let C=a;if(h[11]!==C||h[12]!==w||h[13]!==F||h[14]!==y||h[15]!==j?(c=()=>{w?j(()=>y.push(F)):C()},d=[C,w,F,y,j],h[11]=C,h[12]=w,h[13]=F,h[14]=y,h[15]=j,h[16]=c,h[17]=d):(c=h[16],d=h[17]),(0,u.useEffect)(c,d),w&&g){let e;return h[18]!==F||h[19]!==P?(e=(0,i.jsxs)("div",{className:"".concat("logout","__wrap"),children:[(0,i.jsx)("h2",{children:P("authentication:loggedOutInactivity")}),(0,i.jsx)(r.Button,{buttonStyle:"secondary",el:"link",size:"large",url:F,children:P("authentication:logBackIn")})]}),h[18]=F,h[19]=P,h[20]=e):e=h[20],e}return h[21]!==P?(m=(0,i.jsx)(r.LoadingOverlay,{animationDuration:"0ms",loadingText:P("authentication:loggingOut")}),h[21]=P,h[22]=m):m=h[22],m}},80605:function(e,t,a){a.d(t,{ResetPasswordForm:function(){return c}});var n=a(60605),i=a(57437),r=a(76578),l=a(64667),s=a(23521),o=a(16463),u=a(34964);a(2265);let c=e=>{let t,a;let c=(0,n.c)(12),{token:d}=e,m=(0,r.d)(),{config:h}=(0,l.b)(),{admin:f,routes:g,serverURL:p}=h,{routes:v,user:x}=f,{login:j}=v,{admin:w,api:b}=g,S=(0,o.useRouter)(),{fetchFullUser:F}=(0,s.useAuth)();c[0]!==w||c[1]!==F||c[2]!==S||c[3]!==j?(t=async()=>{await F()?S.push(w):S.push((0,u.$)({adminRoute:w,path:j}))},c[0]=w,c[1]=F,c[2]=S,c[3]=j,c[4]=t):t=c[4];let P=t;return c[5]!==b||c[6]!==m||c[7]!==P||c[8]!==p||c[9]!==d||c[10]!==x?(a=(0,i.jsxs)(s.Form,{action:"".concat(p).concat(b,"/").concat(x,"/reset-password"),initialState:{"confirm-password":{initialValue:"",valid:!1,value:""},password:{initialValue:"",valid:!1,value:""},token:{initialValue:d,valid:!0,value:d}},method:"POST",onSuccess:P,children:[(0,i.jsxs)("div",{className:"inputWrap",children:[(0,i.jsx)(s.PasswordField,{field:{name:"password",label:m.t("authentication:newPassword"),required:!0},path:"password",schemaPath:"".concat(x,".password")}),(0,i.jsx)(s.ConfirmPasswordField,{}),(0,i.jsx)(s.HiddenField,{path:"token",schemaPath:"".concat(x,".token"),value:d})]}),(0,i.jsx)(s.FormSubmit,{size:"large",children:m.t("authentication:resetPassword")})]}),c[5]=b,c[6]=m,c[7]=P,c[8]=p,c[9]=d,c[10]=x,c[11]=a):a=c[11],a}},97535:function(e,t,a){a.d(t,{ToastAndRedirect:function(){return s}});var n=a(60605),i=a(23521),r=a(16463),l=a(2265);function s(e){let t,a;let s=(0,n.c)(6),{message:o,redirectTo:u}=e,c=(0,r.useRouter)(),{startRouteTransition:d}=(0,i.useRouteTransition)(),m=l.useRef(!1);return s[0]!==o||s[1]!==u||s[2]!==c||s[3]!==d?(t=()=>{let e;return i.toast&&(e=setTimeout(()=>{i.toast.success(o),m.current=!0,d(()=>c.push(u))},100)),()=>{e&&clearTimeout(e)}},a=[c,u,o,d],s[0]=o,s[1]=u,s[2]=c,s[3]=d,s[4]=t,s[5]=a):(t=s[4],a=s[5]),(0,l.useEffect)(t,a),null}}}]);