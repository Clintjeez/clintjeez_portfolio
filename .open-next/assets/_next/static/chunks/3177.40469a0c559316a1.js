"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3177],{73177:function(e,l,a){a.r(l),a.d(l,{UploadComponent:function(){return x}});var t=a(56095),o=a(31567),i=a(68458),n=a(28724),s=a(57437),c=a(17433),d=a(46778),r=a(64667),u=a(23521),p=a(76578),h=a(50429),m=a(2265),v="lexical-upload",b={depth:0},g=e=>{var l,a,g,x;let{data:{fields:_,relationTo:f,value:j},nodeKey:w}=e;if("object"==typeof j)throw Error("Upload value should be a string or number. The Lexical Upload component should not receive the populated value object.");let{config:{routes:{api:D},serverURL:N},getEntityConfig:C}=(0,r.b)(),S=(0,m.useRef)(null),{uuid:k}=(0,n.b)(),y=(0,u.useEditDepth)(),[P]=(0,c.g)(),{editorConfig:R,fieldProps:{readOnly:E,schemaPath:U}}=(0,n.b)(),{i18n:B,t:L}=(0,p.d)(),[F,I]=(0,m.useReducer)(e=>e+1,0),[T]=(0,m.useState)(()=>C({collectionSlug:f})),K=(0,m.useId)(),z=(0,u.formatDrawerSlug)({slug:"lexical-upload-drawer-"+k+K,depth:y}),{toggleDrawer:A}=(0,o.a)(z,!0),{closeDocumentDrawer:M,DocumentDrawer:O,DocumentDrawerToggler:q}=(0,i.a)({id:j,collectionSlug:T.slug}),[{data:G},{setParams:H}]=(0,u.usePayloadAPI)("".concat(N).concat(D,"/").concat(T.slug,"/").concat(j),{initialParams:b}),J=(null==G?void 0:G.thumbnailURL)||(null==G?void 0:G.url),Q=(0,m.useCallback)(()=>{P.update(()=>{var e;null===(e=(0,h.gID)(w))||void 0===e||e.remove()})},[P,w]),V=(0,m.useCallback)(e=>{H({...b,cacheBust:F}),I(),M()},[H,F,M]),W=null==R?void 0:null===(x=R.resolvedFeatureMap)||void 0===x?void 0:null===(g=x.get("upload"))||void 0===g?void 0:null===(a=g.sanitizedClientFeatureProps.collections)||void 0===a?void 0:null===(l=a[T.slug])||void 0===l?void 0:l.hasExtraFields,X=(0,m.useCallback)((e,l)=>{P.update(()=>{let e=(0,h.gID)(w);if(e){let a={...e.getData(),fields:l};e.setData(a)}})},[P,w]);return(0,s.jsxs)("div",{className:v,contentEditable:!1,ref:S,children:[(0,s.jsxs)("div",{className:"".concat(v,"__card"),children:[(0,s.jsxs)("div",{className:"".concat(v,"__topRow"),children:[(0,s.jsx)("div",{className:"".concat(v,"__thumbnail"),children:J?(0,s.jsx)("img",{alt:null==G?void 0:G.filename,"data-lexical-upload-id":j,"data-lexical-upload-relation-to":f,src:J}):(0,s.jsx)(u.File,{})}),(0,s.jsxs)("div",{className:"".concat(v,"__topRowRightPanel"),children:[(0,s.jsx)("div",{className:"".concat(v,"__collectionLabel"),children:(0,d.i)(T.labels.singular,B)}),P.isEditable()&&(0,s.jsxs)("div",{className:"".concat(v,"__actions"),children:[W?(0,s.jsx)(u.Button,{buttonStyle:"icon-label",className:"".concat(v,"__upload-drawer-toggler"),disabled:E,el:"button",icon:"edit",onClick:()=>{A()},round:!0,tooltip:L("fields:editRelationship")}):null,(0,s.jsx)(u.Button,{buttonStyle:"icon-label",className:"".concat(v,"__swap-drawer-toggler"),disabled:E,el:"button",icon:"swap",onClick:()=>{P.dispatchCommand(t.c,{replace:{nodeKey:w}})},round:!0,tooltip:L("fields:swapUpload")}),(0,s.jsx)(u.Button,{buttonStyle:"icon-label",className:"".concat(v,"__removeButton"),disabled:E,icon:"x",onClick:e=>{e.preventDefault(),Q()},round:!0,tooltip:L("fields:removeUpload")})]})]})]}),(0,s.jsx)("div",{className:"".concat(v,"__bottomRow"),children:(0,s.jsx)(q,{className:"".concat(v,"__doc-drawer-toggler"),children:(0,s.jsx)("strong",{children:null==G?void 0:G.filename})})})]}),j?(0,s.jsx)(O,{onSave:V}):null,W?(0,s.jsx)(t.a,{data:_,drawerSlug:z,drawerTitle:L("general:editLabel",{label:(0,d.i)(T.labels.singular,B)}),featureKey:"upload",handleDrawerSubmit:X,schemaPath:U,schemaPathSuffix:T.slug}):null]})},x=e=>(0,s.jsx)(t.b,{...e,uploads:!0,children:(0,s.jsx)(g,{...e})})}}]);